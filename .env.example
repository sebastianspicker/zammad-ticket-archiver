# Copy to `.env` and adjust values. Do not commit secrets.
#
# Precedence: environment > YAML (CONFIG_PATH) > defaults.
# See docs/config-reference.md for complete key reference.

# Optional YAML config path
# CONFIG_PATH=./config/config.yaml

# Server
SERVER_HOST=0.0.0.0
SERVER_PORT=8080

# Logging / metrics
LOG_LEVEL=INFO
# LOG_FORMAT=human        # human|json
# LOG_JSON=false          # legacy json toggle
# METRICS_ENABLED=false

# Zammad
ZAMMAD_BASE_URL=https://zammad.example.local
ZAMMAD_API_TOKEN=change-me
# ZAMMAD_TIMEOUT_SECONDS=10
# ZAMMAD_VERIFY_TLS=true

# Webhook authentication (recommended)
# If set, /ingest requires X-Hub-Signature: sha1=<hex>
WEBHOOK_HMAC_SECRET=change-me

# Legacy fallback (avoid unless needed)
# WEBHOOK_SHARED_SECRET=change-me

# Unsigned mode (internal testing only)
# HARDENING_WEBHOOK_ALLOW_UNSIGNED=true

# Optional: require X-Zammad-Delivery header on /ingest
# HARDENING_WEBHOOK_REQUIRE_DELIVERY_ID=true

# Workflow
# WORKFLOW_TRIGGER_TAG=pdf:sign
# WORKFLOW_REQUIRE_TAG=true
# WORKFLOW_DELIVERY_ID_TTL_SECONDS=3600

# Custom field names in Zammad
# FIELDS_ARCHIVE_PATH=archive_path
# FIELDS_ARCHIVE_USER_MODE=archive_user_mode

# Storage
STORAGE_ROOT=/mnt/archive
# STORAGE_ATOMIC_WRITE=true
# STORAGE_FSYNC=true

# Ingress hardening
# MAX_BODY_BYTES=1048576
# RATE_LIMIT_ENABLED=true
# RATE_LIMIT_RPS=5
# RATE_LIMIT_BURST=10
# RATE_LIMIT_INCLUDE_METRICS=false

# Egress transport hardening
# HARDENING_TRANSPORT_TRUST_ENV=false
# HARDENING_TRANSPORT_ALLOW_LOCAL_UPSTREAMS=false
# HARDENING_TRANSPORT_ALLOW_INSECURE_HTTP=false
# HARDENING_TRANSPORT_ALLOW_INSECURE_TLS=false

# PDF rendering
PDF_TEMPLATE_VARIANT=default
PDF_LOCALE=de_DE
PDF_TIMEZONE=Europe/Berlin
# PDF_MAX_ARTICLES=250    # 0 disables limit

# Signing (optional)
SIGNING_ENABLED=false
SIGNING_PFX_PATH=/run/secrets/signing.pfx
SIGNING_PFX_PASSWORD=
# SIGNING_REASON=Ticket Archivierung
# SIGNING_LOCATION=Datacenter

# RFC3161 timestamping (optional, requires signing)
# TSA_ENABLED=false
# TSA_URL=https://tsa.example.local/rfc3161
# TSA_TIMEOUT_SECONDS=10
# TSA_CA_BUNDLE_PATH=/etc/ssl/certs/tsa-ca.pem
# TSA_USER=
# TSA_PASS=

# Optional template override root (folder containing variant subfolders)
# TEMPLATES_ROOT=/opt/zammad-pdf-archiver/templates

# Optional variables for scripts/ops/mount-cifs.sh
# CIFS_REMOTE=//fileserver.example.local/share
# CIFS_MOUNTPOINT=/mnt/archive
# CIFS_USERNAME=archive-user
# CIFS_PASSWORD=change-me
# CIFS_DOMAIN=EXAMPLE
